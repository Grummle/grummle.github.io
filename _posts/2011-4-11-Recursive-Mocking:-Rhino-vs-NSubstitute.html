---
layout: blog
title: "Recursive Mocking: Rhino vs NSubstitute"
---
<span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;">I'm toying with the idea of ditching</span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;">&nbsp;</span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><span class="il" style="background-attachment: initial; background-clip: initial; background-color: #ffff88; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; color: #222222;">Rhino</span></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;">&nbsp;</span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;">mocks. I've always felt pretty lost when trying to use it and have to look up examples pretty much every time. I rarely 'mock' anything and the stubbing leaves something to be desired from the syntax and usability standpoint.</span><br /><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;">Anyway what has brought this to a head is that I'm doing a service and it has a&nbsp;dependency&nbsp;on IConfiguration. I knew/know&nbsp;<span class="il" style="background-attachment: initial; background-clip: initial; background-color: #ffff88; background-image: initial; background-origin: initial; background-position: initial initial; background-repeat: initial initial; color: #222222;">Rhino</span>&nbsp;mocks has a recursive mocking ability so I thought I'd use that.</div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;IConfiguration config = MockRepository.GenerateMock&lt;<wbr></wbr>IConfiguration&gt;();</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;config.Stub(x =&gt; x.Data.OurApp.<wbr></wbr>ConnectionString).Return("<wbr></wbr>SomeConnectionString");</div><div><br /></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Assert.AreEqual("<wbr></wbr>SomeConnectionString",config.<wbr></wbr>Data.OurApp.<wbr></wbr>ConnectionString);</div></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;">This works as expected. However if you complicate it a little....</div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;IConfiguration config = MockRepository.GenerateMock&lt;<wbr></wbr>IConfiguration&gt;();</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;config.Stub(x =&gt; x.Data.OurApp.<wbr></wbr>ConnectionString).Return("<wbr></wbr>SomeConnectionString");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;config.Stub(x =&gt; x.Web.Sites.OurApp.Urls.<wbr></wbr>ClientFiles).Return(new{new Uri("<a href="http://www.google.com/" style="color: #0000cc;" target="_blank">http://www.google.com</a>"));</div><div><br /></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Assert.AreEqual("<wbr></wbr>SomeConnectionString",config.<wbr></wbr>Data.OurApp.<wbr></wbr>ConnectionString);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Assert.AreEqual("<a href="http://www.google.com/" style="color: #0000cc;" target="_blank">http://www.<wbr></wbr>google.com</a>",config.Web.Sites.OurApp.Urls.ClientFiles.<wbr></wbr>ToString());</div></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;">I start to have issues and I haven't been able to find a way to get it to let me set more then one property recursively.</div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;">I just started playing with NSubstitue. Here is the same stuff/more and it works as expected.</div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><div>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;IConfiguration config = Substitute.For<iconfiguration><wbr></wbr>();</iconfiguration></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;config.Data.OurApp.<wbr></wbr>ConnectionString.Returns("<wbr></wbr>asdf");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;config.Data.OurApp2.<wbr></wbr>ConnectionString.Returns("<wbr></wbr>sele");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;config.Paths.PmtaDumpFolder.<wbr></wbr>UncPath.Returns("uncpath");</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;config.Paths.PmtaDumpFolder.<wbr></wbr>LocalPath.Returns("localpath")<wbr></wbr>;</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;config.Web.Sites.OurApp.<wbr></wbr>Urls.ClientFiles.Returns(new Uri("<a href="http://www.google.com/" style="color: #0000cc;" target="_blank">http://www.google.com</a>"));</div><div><br /></div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(config.<wbr></wbr>Data.OurApp.<wbr></wbr>ConnectionString);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(config.<wbr></wbr>Data.OurApp2.<wbr></wbr>ConnectionString);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(config.<wbr></wbr>Paths.PmtaDumpFolder.UncPath);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(config.<wbr></wbr>Paths.PmtaDumpFolder.<wbr></wbr>LocalPath);</div><div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Console.WriteLine(config.Web.<wbr></wbr>Sites.OurApp.Urls.<wbr></wbr>ClientFiles.ToString());</div></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></div><div style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;">Thoughts feelings?</div>
